{{/*
Copyright 2025 Tencent
SPDX-License-Identifier: MIT

Secrets for aiplusall-kb components.

IMPORTANT: For production deployments, use one of these approaches:
1. Set values via --set flags during installation
2. Use External Secrets Operator with cloud secret managers
3. Use sealed-secrets for GitOps workflows
4. Provide an existing secret via secrets.existingSecret
*/}}
{{- if not .Values.secrets.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "aiplusall-kb.secretName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "aiplusall-kb.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Database credentials
  DB_USER: {{ .Values.secrets.dbUser | quote }}
  DB_PASSWORD: {{ required "secrets.dbPassword is required" .Values.secrets.dbPassword | quote }}
  DB_NAME: {{ .Values.secrets.dbName | quote }}
  # Redis credentials
  REDIS_PASSWORD: {{ required "secrets.redisPassword is required" .Values.secrets.redisPassword | quote }}
  # Application secrets
  JWT_SECRET: {{ required "secrets.jwtSecret is required" .Values.secrets.jwtSecret | quote }}
  TENANT_AES_KEY: {{ .Values.secrets.tenantAesKey | default (randAlphaNum 32) | quote }}
{{- end }}
